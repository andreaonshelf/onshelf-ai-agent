# Data Protection Migration Report

Found 105 scripts needing protection updates


## ./
79 files need updates

### trace_fake_data_insertion.py
- Hardcoded ID reference

### check_all_paths.py
- Direct update without protection

### test_extraction_with_fallback.py
- Test data definition

### revert_model_changes.py
- Direct update without protection

### investigate_empty_fields.py
- Hardcoded ID reference

### debug_queue_item_9_config.py
- Hardcoded ID reference

### force_process_item.py
- Direct update without protection

### get_real_extraction_timeline.py
- Hardcoded ID reference

### disable_gemini_temporarily.py
- Direct update without protection

### check_media_files_detailed.py
- Direct update without protection

### verify_prompt_table_state.py
- Direct delete without protection
- Direct insert without validation

### test_queue_item_9_simple.py
- Hardcoded ID reference

### fix_planogram_generation.py
- Direct update without protection

### fix_image_paths.py
- Direct update without protection

### debug_queue_item_9_processing.py
- Hardcoded ID reference

### backend_model_integration.py
- Direct update without protection

### check_image_paths.py
- Hardcoded ID reference

### fix_all_prompt_fields.py
- Direct update without protection

### fix_existing_queue_configs.py
- Direct update without protection

### parse_prompts_clean.py
- Direct update without protection

### cleanup_and_verify_prompts.py
- Direct delete without protection

### fix_empty_field_configs.py
- Direct update without protection

### check_current_schema.py
- Direct delete without protection
- Direct insert without validation

### fix_queue_item_9.py
- Direct update without protection
- Hardcoded ID reference

### find_prompt_storage.py
- Direct delete without protection
- Direct insert without validation
- Test data definition

### trace_queue_display.py
- Hardcoded ID reference

### debug_queue_item_9.py
- Hardcoded ID reference

### add_missing_prompt_endpoints.py
- Direct update without protection
- Direct insert without validation

### debug_dynamic_model_issue.py
- Test data definition

### find_image_paths.py
- Direct update without protection
- Hardcoded ID reference

### fix_extraction_model_building.py
- Test data definition

### restore_user_configs.py
- Direct update without protection

### parse_document_to_fields.py
- Direct update without protection

### parse_document_correctly.py
- Direct update without protection

### add_configuration_endpoints.py
- Direct update without protection
- Direct delete without protection
- Direct insert without validation

### debug_queue_item_9_model_building.py
- Hardcoded ID reference

### dashboard.py
- Test data definition

### run_queue_processor.py
- Direct update without protection

### fix_queue_item_9_final.py
- Direct update without protection
- Hardcoded ID reference

### remove_gemini_from_queue.py
- Direct update without protection

### check_prompt_templates_columns.py
- Direct delete without protection
- Direct insert without validation
- Test data definition

### examine_field_structure.py
- Hardcoded ID reference

### attempt_data_recovery.py
- Hardcoded ID reference

### fix_database_and_insert_prompts.py
- Direct delete without protection
- Direct insert without validation

### fix_queue_item_9_properly.py
- Direct update without protection
- Hardcoded ID reference

### fix_field_parsing_duplicates.py
- Direct update without protection

### save_prompts_from_md.py
- Direct insert without validation

### test_extraction_fix.py
- Test data definition

### fix_all_queue_paths.py
- Direct update without protection

### FORCE_REAL_EXTRACTION.py
- Direct update without protection
- Hardcoded ID reference

### QUARANTINE_DANGEROUS_SCRIPTS.py
- Direct update without protection
- Hardcoded ID reference

### debug_queue_config.py
- Hardcoded ID reference

### update_field_definitions.py
- Direct update without protection

### check_real_extraction_data.py
- Hardcoded ID reference

### test_field_loading_fix.py
- Hardcoded ID reference

### fix_product_v1_fields.py
- Direct update without protection

### run_field_definitions_migration_supabase.py
- Direct insert without validation

### fix_invalid_model_ids.py
- Direct update without protection

### parse_extraction_prompts_complete.py
- Direct update without protection

### execute_field_schema_supabase.py
- Direct update without protection

### test_data_parsing.py
- Hardcoded ID reference

### parse_and_update_prompts.py
- Direct update without protection

### show_real_extraction_timeline.py
- Hardcoded ID reference

### update_complete_prompts.py
- Direct update without protection

### add_missing_prompts.py
- Direct insert without validation

### fix_prompt_fields_format.py
- Direct update without protection

### execute_remaining_sqls.py
- Direct insert without validation

### update_pydantic_schemas.py
- Direct update without protection

### update_all_prompts_exact_fields.py
- Direct update without protection

### update_prompts_to_v1.py
- Direct update without protection

### dashboard_backup.py
- Test data definition

### debug_dynamic_model_simple.py
- Test data definition

### build_complete_config_with_fields.py
- Direct update without protection
- Hardcoded ID reference

### fix_all_queue_gemini.py
- Direct update without protection

### check_queue_item_9_results.py
- Hardcoded ID reference

### remove_duplicates.py
- Direct update without protection

### fix_all_invalid_model_ids.py
- Direct update without protection

### find_extraction_config.py
- Hardcoded ID reference

### fix_queue_gemini.py
- Direct update without protection
- Hardcoded ID reference


## ./archive/migrations/
2 files need updates

### final_prompt_fixes.py
- Direct delete without protection
- Direct insert without validation

### test_critical_fixes.py
- Test data definition


## ./backup_before_revert/
3 files need updates

### prompt_management.py
- Direct insert without validation

### prompt_evolution.py
- Direct insert without validation

### performance_tracker.py
- Direct insert without validation


## ./scripts/
1 files need updates

### example_safe_database_update.py
- Direct update without protection


## ./src/agent/
1 files need updates

### agent.py
- Direct insert without validation


## ./src/api/
13 files need updates

### prompt_management.py
- Direct update without protection
- Direct insert without validation

### queue_processing.py
- Direct update without protection
- Direct insert without validation

### configurations.py
- Direct update without protection
- Direct insert without validation

### extraction_config.py
- Direct update without protection

### feedback.py
- Direct update without protection
- Direct insert without validation

### planogram_editor.py
- Direct insert without validation

### queue_management.py
- Direct update without protection
- Direct delete without protection

### image_analysis.py
- Direct insert without validation

### image_management.py
- Direct insert without validation

### prompt_library.py
- Direct insert without validation

### field_definitions.py
- Direct update without protection
- Direct insert without validation

### analytics.py
- Direct update without protection
- Direct insert without validation

### prompt_management_missing.py
- Direct update without protection
- Direct insert without validation


## ./src/extraction/
2 files need updates

### prompt_evolution.py
- Direct insert without validation

### performance_tracker.py
- Direct insert without validation


## ./src/orchestrator/
2 files need updates

### system_dispatcher.py
- Direct update without protection

### master_orchestrator_backup.py
- Direct update without protection


## ./src/utils/
1 files need updates

### model_usage_tracker.py
- Direct update without protection
- Direct insert without validation


## ./tests/fixtures/
1 files need updates

### test_data.py
- Direct delete without protection
- Direct insert without validation


## Migration Instructions

1. **For Update Operations:**
   ```python
   # Before:
   supabase.table('queue').update(data).eq('id', 9).execute()
   
   # After:
   from src.database.protection_v2 import DataProtection
   DataProtection.safe_update(supabase, 'queue', 9, data)
   ```

2. **For Insert Operations:**
   ```python
   # Before:
   supabase.table('queue').insert(data).execute()
   
   # After:
   from src.database.protection_v2 import DataProtection
   DataProtection.safe_insert(supabase, 'queue', data)
   ```

3. **For Test Data:**
   ```python
   # Before:
   test_data = {'name': 'Coca Cola', ...}
   
   # After:
   from tests.fixtures.test_data import TestDataFactory
   test_data = TestDataFactory.create_test_extraction()
   ```

4. **Add Environment Check:**
   ```python
   from src.config.environment import require_production_check
   
   @require_production_check
   def dangerous_function():
       # This won't run in production
   ```