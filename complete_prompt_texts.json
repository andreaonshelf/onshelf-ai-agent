{
  "structure_v1": "Analyze this retail shelf image to identify the physical structure.\n\nCOUNT:\n\u25a1 Number of horizontal shelves (bottom = 1, count up)\n\u25a1 Each product display level = one shelf\n\u25a1 Include floor level only if products are placed there\n\nMEASURE:\n\u25a1 Fixture width: _____ meters (estimate)\n\u25a1 Fixture height: _____ meters (estimate)\n\u25a1 Fixture type: wall_shelf | gondola | end_cap | cooler | freezer | bin | pegboard | other\n\nIDENTIFY NON-PRODUCT ELEMENTS:\n\u25a1 Security devices: grids, magnetic tags, plastic cases, bottle locks\n\u25a1 Promotional materials: shelf wobblers, hanging signs, price cards, banners\n\u25a1 Shelf equipment: dividers, pushers, price rails, shelf strips\n\u25a1 Display accessories: hooks, clip strips, shelf talkers\n\u25a1 Fixtures: end panels, header boards, base decks\n\nOutput the total shelf count and all fixture details.\n\n{IF_RETRY}\nPREVIOUS ATTEMPT: {SHELVES} shelves found\nUncertainty areas: {PROBLEM_AREAS}\n\nCommon issues to verify:\n- Is the bottom/floor level actually holding products?\n- Are there partial shelves at the top?\n- Did they count dividers as separate shelves?\n\nNOTE: Trust your own analysis over previous attempts.\n{/IF_RETRY}",
  "product_v1": "STAGE 2: PRODUCT EXTRACTION\n\nAnalyze this retail shelf image to identify the products present on the shelf. \n\nWe have already identified that {TOTAL_SHELVES} horizontal shelves exist, numbered from bottom (1) to top ({TOTAL_SHELVES}).\n\nWHAT YOU'RE BUILDING:\nYou are extracting product data that will be converted into a planogram. A planogram is a visual diagram showing product placement on shelves - like a map of the shelf. Your data will become a grid where each product facing gets its own cell.\n\nHOW YOUR EXTRACTION BECOMES VISUAL:\n- Each product facing (unit visible from front) = one cell in the grid\n- Position 1,2,3 = left-to-right order in the planogram\n- Gaps in position numbers = empty space in the visual\n- Example: If you extract positions 1,2,5, the planogram shows: [Prod1][Prod2][Empty][Empty][Prod5]\n\nEXTRACT:\n1. Scan left to right, identify each distinct product\n2. Count facings (units visible from front only)\n3. Number products sequentially: 1, 2, 3, 4... (continuous numbering)\n4. Track significant gaps between products separately (will be recorded in gaps array)\n5. Note section: Left | Center | Right (divide shelf in thirds)\n\nCRITICAL: Missing positions create gaps in the planogram. Only skip numbers if there's actual empty space on the shelf.\n\nHANDLE THESE SITUATIONS:\n- Shelf completely blocked: Mark extraction_status as \"blocked\"\n- Shelf not visible: Mark extraction_status as \"not_visible\"\n- Products knocked over/pile: Note in extraction_notes\n- Bottom shelf cut off: Extract visible shelves only\n\n{IF_RETRY}\nPREVIOUS FOUND ON THIS SHELF:\n{PREVIOUS_SHELF_PRODUCTS}\n\nVISUAL FEEDBACK:\n{PLANOGRAM_FEEDBACK}\nExample: \"Shelf looks too sparse - check for missed products\"\n\nNOTE: Trust what you see. Add/correct products as needed.\nYou can disagree with the previous extraction completely.\n{/IF_RETRY}",
  "detail_v1": "STAGE 3: DETAIL ENHANCEMENT\n\nLook at this retail shelf image.\n\nWe have already identified and located these products:\n\n{COMPLETE_PRODUCT_LIST}\nExample format:\n=== FIXTURE: store123_aisle5_bay2 ===\nTotal Shelves: 3\n\nSHELF 1 (Bottom):\n- Product 1: Coca-Cola Zero (6 facings) - Left section\n- Product 2: [Gap - 2 product spaces]\n- Product 3: Pepsi Max (4 facings) - Center section\n- Product 4: Fanta Orange (3 facings) - Center section\n\nSHELF 2:\n- Product 1: Budweiser (8 facings) - Left section\n- Product 2: Heineken (6 facings) - Center section\n\nSHELF 3 (Top):\n[Empty shelf - no products]\n\nYOUR TASK:\nAdd details to EACH product above IN ORDER. You cannot skip, add, or remove products.\n\nFor each product, find it in the image and extract:\n\nPRICING (check shelf edge labels):\n\u25a1 Regular price: \u00a3_____ \n\u25a1 Price tag location: directly_below | left_of_product | right_of_product | distant | not_visible\n\u25a1 Confidence this price belongs to THIS product: certain | likely | uncertain\n\u25a1 If uncertain, which product might this price belong to: _____\n\u25a1 Promotional price: \u00a3_____ (if different)\n\u25a1 Promotion text: _____ (e.g., \"3 for \u00a35\")\n\u25a1 Currency: GBP | EUR | USD | other\n\nVERIFICATION NOTES:\n- If price tag is between two products, note which product it's closer to\n- If no direct price visible, note where you looked\n- Multi-packs often share one price tag for the group\n\nPACKAGE DETAILS (read from product):\n\u25a1 Package size: _____ (e.g., \"330ml\", \"750ml\", \"6-pack\")\n\u25a1 Size location on package: front_label | side_visible | cap/lid | not_visible\n\u25a1 Confidence in size reading: certain | likely | uncertain\n\u25a1 If multipack: unit size and count\n\u25a1 Multiple units visible: Yes/No (helps verify if truly multipack)\n\u25a1 Total volume: _____ (e.g., \"6 \u00d7 330ml = 1,980ml\")\n\nPHYSICAL CHARACTERISTICS:\n\u25a1 Width relative to neighbors: narrow | normal | wide\n\u25a1 Height relative to shelf: short | medium | tall\n\u25a1 Estimated dimensions: width ___cm, height ___cm\n\nVISUAL APPEARANCE:\n\u25a1 Primary color: _____ (most dominant)\n\u25a1 Secondary color: _____ (second most prominent)\n\u25a1 Package finish: metallic | matte | glossy | transparent\n\nEXTRACTION QUALITY:\n\u25a1 Visibility: clearly_visible | partially_obscured | mostly_hidden\n\u25a1 Confidence: high | medium | low\n\u25a1 Issues: _____ (e.g., \"price tag torn\")\n\nProcess EVERY product systematically.\n\n{IF_RETRY}\nPREVIOUS ATTEMPT RESULTS:\n{PREVIOUS_DETAILS_BY_PRODUCT}\n\nIssues identified:\n- Missing details for: {INCOMPLETE_PRODUCTS}\n- Low confidence items: {LOW_CONFIDENCE_PRODUCTS}\n\nFill in missing information and verify previous extractions.\n{/IF_RETRY}",
  "visual_v1": "Compare the original shelf photo with the generated planogram visualization.\n\nCHECK THESE SPECIFIC THINGS:\n\n1. SHELF ASSIGNMENT: Do all products appear on the correct shelf?\n   - List any products that are on a different shelf in the photo vs planogram\n   \n2. QUANTITY CHECK: Are the facing counts roughly correct?\n   - List any products where quantity is significantly off (\u00b13 or more)\n   \n3. POSITION CHECK: Are products in the right general area of each shelf?\n   - List any products that are in wrong section (left/center/right)\n   \n4. MISSING PRODUCTS: Any obvious products in photo but not in planogram?\n   - List only if clearly visible and significant\n   \n5. EXTRA PRODUCTS: Any products in planogram but not visible in photo?\n   - List only if you're confident they're not there\n\nFor each issue found, specify:\n- What: [Product name]\n- Where in photo: [Shelf X, Position Y]\n- Where in planogram: [Shelf X, Position Y]\n- Confidence: [High/Medium/Low]"
}